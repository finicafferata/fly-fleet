openapi: 3.0.3
info:
  title: Fly-Fleet API
  description: Private Jet Charter Brokerage Platform API
  version: 1.0.0
  contact:
    name: Fly-Fleet Support
    email: contact@fly-fleet.com
  license:
    name: Private
servers:
  - url: http://localhost:3000
    description: Development server
tags:
  - name: quotes
    description: Quote request management
  - name: contact
    description: Contact form handling
  - name: airports
    description: Airport search functionality
  - name: content
    description: Content management system
  - name: faqs
    description: FAQ management
  - name: analytics
    description: Event tracking and analytics
  - name: whatsapp
    description: WhatsApp integration
  - name: webhooks
    description: External service webhooks
  - name: recaptcha
    description: reCAPTCHA verification
  - name: seo
    description: SEO metadata generation
  - name: admin
    description: Administrative operations
paths:
  /api/admin/email-activities:
    get:
      summary: List admin
      description: Administrative operations requiring authentication
      tags:
        - admin
        - admin
      responses:
        '200':
          description: Success
        '500':
          $ref: '#/components/responses/InternalError'
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
          description: Maximum number of results
        - name: offset
          in: query
          schema:
            type: integer
          description: Pagination offset
        - name: status
          in: query
          schema:
            type: string
          description: Filter by status
  /api/admin/email-stats:
    get:
      summary: List admin
      description: Administrative operations requiring authentication
      tags:
        - admin
        - admin
      responses:
        '200':
          description: Success
        '500':
          $ref: '#/components/responses/InternalError'
  /api/admin/quotes:
    get:
      summary: List admin
      description: Administrative operations requiring authentication
      tags:
        - admin
        - admin
      responses:
        '200':
          description: Success
        '400':
          $ref: '#/components/responses/ValidationError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '500':
          $ref: '#/components/responses/InternalError'
      security:
        - AdminAuth: []
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
          description: Maximum number of results
        - name: offset
          in: query
          schema:
            type: integer
          description: Pagination offset
        - name: status
          in: query
          schema:
            type: string
          description: Filter by status
    post:
      summary: Create admin
      description: Administrative operations requiring authentication
      tags:
        - admin
        - admin
      responses:
        '200':
          description: Success
        '400':
          $ref: '#/components/responses/ValidationError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '500':
          $ref: '#/components/responses/InternalError'
      security:
        - AdminAuth: []
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
          description: Maximum number of results
        - name: offset
          in: query
          schema:
            type: integer
          description: Pagination offset
        - name: status
          in: query
          schema:
            type: string
          description: Filter by status
  /api/airports:
    get:
      summary: List airports
      description: Search and retrieve airport information
      tags:
        - airports
      responses:
        '200':
          description: Success
        '400':
          $ref: '#/components/responses/ValidationError'
        '500':
          $ref: '#/components/responses/InternalError'
      parameters:
        - name: q
          in: query
          schema:
            type: string
          description: Search query
        - name: locale
          in: query
          schema:
            type: string
            enum:
              - es
              - en
              - pt
          description: Language locale
  /api/contact:
    post:
      summary: Create contact
      description: Handle contact form submissions and inquiries
      tags:
        - contact
      responses:
        '200':
          description: Success
        '400':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitError'
        '500':
          $ref: '#/components/responses/InternalError'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ContactFormSchema'
  /api/content/{page}/{locale}:
    get:
      summary: List content
      description: Manage CMS content with multilingual support
      tags:
        - content
      responses:
        '200':
          description: Success
        '500':
          $ref: '#/components/responses/InternalError'
      parameters:
        - name: page
          in: path
          required: true
          schema:
            type: string
          description: Page parameter
        - name: locale
          in: path
          required: true
          schema:
            type: string
          description: Locale parameter
  /api/content:
    get:
      summary: List content
      description: Manage CMS content with multilingual support
      tags:
        - content
      responses:
        '200':
          description: Success
        '500':
          $ref: '#/components/responses/InternalError'
      parameters:
        - name: locale
          in: query
          schema:
            type: string
            enum:
              - es
              - en
              - pt
          description: Language locale
        - name: action
          in: query
          schema:
            type: string
          description: Action to perform
    post:
      summary: Create content
      description: Manage CMS content with multilingual support
      tags:
        - content
      responses:
        '200':
          description: Success
        '500':
          $ref: '#/components/responses/InternalError'
      parameters:
        - name: locale
          in: query
          schema:
            type: string
            enum:
              - es
              - en
              - pt
          description: Language locale
        - name: action
          in: query
          schema:
            type: string
          description: Action to perform
  /api/faqs/{locale}:
    get:
      summary: List faqs
      description: Manage frequently asked questions
      tags:
        - faqs
      responses:
        '200':
          description: Success
        '500':
          $ref: '#/components/responses/InternalError'
      parameters:
        - name: limit
          in: query
          schema:
            type: integer
          description: Maximum number of results
        - name: category
          in: query
          schema:
            type: string
          description: Filter by category
        - name: search
          in: query
          schema:
            type: string
          description: Search term
        - name: grouped
          in: query
          schema:
            type: boolean
          description: Group results
        - name: locale
          in: path
          required: true
          schema:
            type: string
          description: Locale parameter
  /api/faqs:
    get:
      summary: List faqs
      description: Manage frequently asked questions
      tags:
        - faqs
      responses:
        '200':
          description: Success
        '500':
          $ref: '#/components/responses/InternalError'
      parameters:
        - name: locale
          in: query
          schema:
            type: string
            enum:
              - es
              - en
              - pt
          description: Language locale
        - name: action
          in: query
          schema:
            type: string
          description: Action to perform
    post:
      summary: Create faqs
      description: Manage frequently asked questions
      tags:
        - faqs
      responses:
        '200':
          description: Success
        '500':
          $ref: '#/components/responses/InternalError'
      parameters:
        - name: locale
          in: query
          schema:
            type: string
            enum:
              - es
              - en
              - pt
          description: Language locale
        - name: action
          in: query
          schema:
            type: string
          description: Action to perform
  /api/health:
    get:
      summary: List health
      description: GET operation for health
      tags:
        - health
      responses:
        '200':
          description: Success
        '500':
          $ref: '#/components/responses/InternalError'
  /api/quote:
    post:
      summary: Create quote
      description: POST operation for quote
      tags:
        - quote
      responses:
        '200':
          description: Success
        '400':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitError'
        '500':
          $ref: '#/components/responses/InternalError'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              description: Request body schema (auto-detected)
  /api/quotes/{id}/status:
    get:
      summary: Get quotes
      description: Manage quote requests for private jet charter services
      tags:
        - quotes
      responses:
        '200':
          description: Success
        '400':
          $ref: '#/components/responses/ValidationError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '500':
          $ref: '#/components/responses/InternalError'
      security:
        - AdminAuth: []
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Id parameter
    patch:
      summary: Partially update quotes
      description: Manage quote requests for private jet charter services
      tags:
        - quotes
      responses:
        '200':
          description: Success
        '400':
          $ref: '#/components/responses/ValidationError'
        '401':
          $ref: '#/components/responses/UnauthorizedError'
        '403':
          $ref: '#/components/responses/ForbiddenError'
        '500':
          $ref: '#/components/responses/InternalError'
      security:
        - AdminAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/QuoteStatusUpdateSchema'
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: Id parameter
  /api/recaptcha/verify:
    get:
      summary: List recaptcha
      description: Verify reCAPTCHA tokens for security
      tags:
        - recaptcha
      responses:
        '200':
          description: Success
        '400':
          $ref: '#/components/responses/ValidationError'
        '500':
          $ref: '#/components/responses/InternalError'
    post:
      summary: Create recaptcha
      description: Verify reCAPTCHA tokens for security
      tags:
        - recaptcha
      responses:
        '200':
          description: Success
        '400':
          $ref: '#/components/responses/ValidationError'
        '500':
          $ref: '#/components/responses/InternalError'
  /api/seo/{page}/{locale}:
    get:
      summary: List seo
      description: Generate SEO metadata for pages
      tags:
        - seo
      responses:
        '200':
          description: Success
        '500':
          $ref: '#/components/responses/InternalError'
      parameters:
        - name: page
          in: path
          required: true
          schema:
            type: string
          description: Page parameter
        - name: locale
          in: path
          required: true
          schema:
            type: string
          description: Locale parameter
  /api/webhooks/resend:
    get:
      summary: List webhooks
      description: Handle external service webhooks
      tags:
        - webhooks
      responses:
        '200':
          description: Success
        '500':
          $ref: '#/components/responses/InternalError'
    post:
      summary: Create webhooks
      description: Handle external service webhooks
      tags:
        - webhooks
      responses:
        '200':
          description: Success
        '500':
          $ref: '#/components/responses/InternalError'
  /api/webhooks/resend/test:
    get:
      summary: List webhooks
      description: Handle external service webhooks
      tags:
        - webhooks
      responses:
        '200':
          description: Success
        '500':
          $ref: '#/components/responses/InternalError'
    post:
      summary: Create webhooks
      description: Handle external service webhooks
      tags:
        - webhooks
      responses:
        '200':
          description: Success
        '500':
          $ref: '#/components/responses/InternalError'
  /api/whatsapp/link:
    get:
      summary: List whatsapp
      description: Generate WhatsApp communication links
      tags:
        - whatsapp
      responses:
        '200':
          description: Success
        '400':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitError'
        '500':
          $ref: '#/components/responses/InternalError'
    post:
      summary: Create whatsapp
      description: Generate WhatsApp communication links
      tags:
        - whatsapp
      responses:
        '200':
          description: Success
        '400':
          $ref: '#/components/responses/ValidationError'
        '429':
          $ref: '#/components/responses/RateLimitError'
        '500':
          $ref: '#/components/responses/InternalError'
components:
  securitySchemes:
    AdminAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: Admin authentication using Bearer token with x-admin-email header
  schemas:
    Locale:
      type: string
      enum:
        - es
        - en
        - pt
      description: Supported locale codes
    ServiceType:
      type: string
      enum:
        - charter
        - multicity
        - helicopter
        - medical
        - cargo
        - other
      description: Type of aviation service requested
    QuoteStatus:
      type: string
      enum:
        - pending
        - processing
        - quoted
        - converted
        - closed
      description: Status of a quote request
    AdditionalService:
      type: string
      enum:
        - international_support
        - country_documentation
        - pet_friendly_transport
        - ground_transfer_driver
        - premium_catering
        - vip_lounge_fbo
        - customs_immigration_assist
      description: Additional services that can be requested
    ContactFormSchema:
      type: object
      required:
        - email
        - message
        - locale
      properties:
        fullName:
          type: string
          minLength: 2
          maxLength: 100
          description: Full name of the contact (alternative to firstName/lastName)
        firstName:
          type: string
          minLength: 1
          maxLength: 50
          description: First name of the contact
        lastName:
          type: string
          minLength: 1
          maxLength: 50
          description: Last name of the contact
        email:
          type: string
          format: email
          description: Contact email address
        phone:
          type: string
          description: Contact phone number (optional)
        contactViaWhatsApp:
          type: boolean
          description: Preference to be contacted via WhatsApp
        subject:
          type: string
          maxLength: 200
          description: Subject of the inquiry
        message:
          type: string
          minLength: 10
          maxLength: 1000
          description: Contact message content
        locale:
          type: string
          enum:
            - es
            - en
            - pt
          description: Preferred language locale
        recaptchaToken:
          type: string
          description: reCAPTCHA verification token (optional)
        inquiryType:
          type: string
          description: Type of inquiry (optional)
      description: Contact form submission schema. Requires either fullName OR both firstName and lastName.
    QuoteStatusUpdateSchema:
      type: object
      required:
        - status
        - adminEmail
        - adminToken
      properties:
        status:
          type: string
          enum:
            - pending
            - processing
            - quoted
            - converted
            - closed
          description: New status for the quote
        adminNote:
          type: string
          maxLength: 1000
          description: Optional administrative note about the status change
        adminEmail:
          type: string
          format: email
          description: Email of the admin making the change
        adminToken:
          type: string
          minLength: 1
          description: Authentication token for admin access
      description: Schema for updating quote request status
  responses:
    ValidationError:
      description: Request validation failed
      content:
        application/json:
          schema:
            type: object
            properties:
              error:
                type: string
                example: Validation failed
              details:
                type: array
                items:
                  type: object
                  properties:
                    code:
                      type: string
                    path:
                      type: array
                      items:
                        oneOf:
                          - type: string
                          - type: integer
                    message:
                      type: string
    RateLimitError:
      description: Rate limit exceeded
      content:
        application/json:
          schema:
            type: object
            properties:
              error:
                type: string
                example: Rate limit exceeded. Maximum 7 requests per hour.
    UnauthorizedError:
      description: Authentication required
      content:
        application/json:
          schema:
            type: object
            properties:
              error:
                type: string
                example: Authentication required
    ForbiddenError:
      description: Access forbidden
      content:
        application/json:
          schema:
            type: object
            properties:
              error:
                type: string
                example: Access forbidden
    NotFoundError:
      description: Resource not found
      content:
        application/json:
          schema:
            type: object
            properties:
              error:
                type: string
                example: Resource not found
    InternalError:
      description: Internal server error
      content:
        application/json:
          schema:
            type: object
            properties:
              error:
                type: string
                example: Internal server error
